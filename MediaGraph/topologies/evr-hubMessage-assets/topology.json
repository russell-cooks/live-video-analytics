{
  "@apiVersion": "1.0",
  "name": "EVRtoAssetsOnObjDetect",
  "properties": {
    "description": "Event-based video recording to Assets based on specific objects being detected by external inference engine",
    "parameters": [
      
      {
        "name": "hubSourceInput",
        "type": "String",
        "description": "input name for hub source",
        "default": "recordingTrigger"
      }
    ],
    "sources": [
      {
        "@type": "#Microsoft.Media.MediaGraphIoTHubMessageSource",
        "name": "iotMessageSource",
        "hubInputName": "${hubSourceInput}"
      }
    ],
    "processors": [
      {
        "@type": "#Microsoft.Media.MediaGraphSignalGateProcessor",
        "name": "signalGateProcessor",
        "inputs": [
          {
            "nodeName": "iotMessageSource"
          }
        ],
        "activationEvaluationWindow": "PT1S",
        "activationSignalOffset": "-PT5S",
        "minimumActivationTime": "PT30S",
        "maximumActivationTime": "PT30S"
      },
    
    "sinks": [
      {
        "@type": "#Microsoft.Media.MediaGraphAssetSink",
        "name": "assetSink",
        "assetNamePattern": "sampleAssetFromEVR-LVAEdge-${System.DateTime}",
        "segmentLength": "PT30S",
        "LocalMediaCacheMaximumSizeMiB": "2048",
        "localMediaCachePath": "/var/lib/azuremediaservices/tmp/",
        "inputs": [
          {
            "nodeName": "signalGateProcessor"
          }
        ]
      }
    ]
}
